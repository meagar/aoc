instructions = [[2,461,550,564,900], [0,370,39,425,839], [0,464,858,833,915], [0,812,389,865,874], [1,599,989,806,993], [1,376,415,768,548], [1,606,361,892,600], [0,448,208,645,684], [2,50,472,452,788], [2,205,417,703,826], [2,533,331,906,873], [2,857,493,989,970], [0,631,950,894,975], [0,387,19,720,700], [0,511,843,581,945], [2,514,557,662,883], [0,269,809,876,847], [0,149,517,716,777], [0,994,939,998,988], [2,467,662,555,957], [1,952,417,954,845], [1,565,226,944,880], [1,214,319,805,722], [2,532,276,636,847], [2,619,80,689,507], [1,390,706,884,722], [2,17,634,537,766], [2,706,440,834,441], [2,318,207,499,530], [2,698,185,830,343], [2,566,679,744,716], [2,347,482,959,482], [2,39,799,981,872], [1,583,543,846,710], [0,367,664,595,872], [1,805,439,964,995], [2,209,584,513,802], [0,106,497,266,770], [1,975,2,984,623], [0,316,684,369,876], [0,30,309,259,554], [0,399,680,861,942], [2,227,740,850,829], [1,386,603,552,879], [0,703,795,791,963], [0,573,803,996,878], [0,993,939,997,951], [1,809,221,869,723], [0,38,720,682,751], [0,318,732,720,976], [2,88,459,392,654], [0,865,654,911,956], [2,264,284,857,956], [0,281,776,610,797], [2,492,660,647,910], [0,879,703,925,981], [0,772,414,974,518], [1,694,41,755,96], [1,452,406,885,881], [0,107,905,497,910], [0,647,222,910,532], [1,679,40,845,358], [0,144,205,556,362], [1,871,804,962,878], [1,545,676,545,929], [0,316,716,413,941], [2,488,826,755,971], [2,957,832,976,992], [2,857,770,905,964], [2,319,198,787,673], [1,832,813,863,844], [1,818,296,818,681], [1,71,699,91,960], [0,838,578,967,928], [2,440,856,507,942], [2,121,970,151,974], [2,391,192,659,751], [1,78,210,681,419], [1,324,591,593,939], [2,159,366,249,760], [0,617,167,954,601], [2,484,607,733,657], [1,587,96,888,819], [0,680,984,941,991], [1,800,512,968,691], [0,123,588,853,603], [1,1,862,507,912], [1,699,839,973,878], [0,848,89,887,893], [2,344,353,462,403], [1,780,731,841,760], [2,693,973,847,984], [2,989,936,996,958], [2,168,475,206,963], [1,742,683,769,845], [2,768,116,987,396], [1,190,364,617,526], [0,470,266,530,839], [2,122,497,969,645], [0,492,432,827,790], [1,505,636,957,820], [1,295,476,698,958], [2,63,298,202,396], [1,157,315,412,939], [0,69,789,134,837], [0,678,335,896,541], [2,140,516,842,668], [0,697,585,712,668], [2,507,832,578,949], [1,678,279,886,621], [2,449,744,826,910], [0,835,354,921,741], [2,924,878,985,952], [1,666,503,922,905], [1,947,453,961,587], [2,525,190,795,654], [0,62,320,896,362], [1,21,458,972,536], [1,446,429,821,970], [2,376,423,805,455], [2,494,896,715,937], [1,583,270,667,482], [0,183,468,280,548], [2,623,289,750,524], [1,836,706,967,768], [1,419,569,912,908], [1,428,260,660,433], [0,683,627,916,816], [1,447,973,866,980], [1,688,607,938,990], [1,245,187,597,405], [0,558,843,841,942], [0,325,666,713,834], [2,672,606,814,935], [0,161,812,490,954], [1,950,362,985,898], [1,143,22,205,821], [1,89,762,607,790], [2,234,245,827,303], [1,65,599,764,997], [1,232,466,965,695], [1,739,122,975,590], [0,206,112,940,558], [2,690,365,988,552], [1,907,438,977,691], [0,838,809,944,869], [1,222,12,541,832], [2,337,66,669,812], [1,732,821,897,912], [2,182,862,638,996], [1,955,808,983,847], [2,346,227,841,696], [1,983,270,989,756], [0,874,849,876,905], [0,7,760,678,795], [2,973,977,995,983], [0,911,961,914,976], [1,913,557,952,722], [0,607,933,939,999], [1,226,604,517,622], [0,3,564,344,842], [2,340,578,428,610], [1,248,916,687,925], [2,650,185,955,965], [2,831,359,933,536], [0,544,614,896,953], [2,648,939,975,997], [1,464,269,710,521], [0,643,149,791,320], [0,875,549,972,643], [0,953,969,971,972], [0,236,474,772,591], [2,313,212,489,723], [2,896,829,897,837], [2,544,449,995,905], [0,278,645,977,876], [0,887,947,946,977], [1,342,861,725,935], [1,636,316,692,513], [2,857,470,950,528], [0,736,196,826,889], [1,17,878,850,987], [1,142,968,169,987], [1,46,470,912,853], [1,182,252,279,941], [2,261,143,969,657], [0,69,600,518,710], [1,372,379,779,386], [2,867,391,911,601], [0,174,287,900,536], [2,951,842,993,963], [0,626,733,985,827], [2,622,70,666,291], [0,980,671,985,835], [0,477,63,910,72], [0,779,39,940,142], [1,986,570,997,638], [2,842,805,943,985], [0,890,886,976,927], [0,893,172,897,619], [0,198,780,835,826], [2,202,209,219,291], [0,193,52,833,283], [2,414,427,987,972], [1,375,231,668,236], [0,646,598,869,663], [2,271,462,414,650], [0,679,121,845,467], [2,76,847,504,904], [0,15,617,509,810], [2,248,105,312,451], [0,126,546,922,879], [1,531,831,903,872], [2,602,431,892,792], [0,795,223,892,623], [2,167,721,533,929], [2,813,251,998,484], [2,64,640,752,942], [1,155,955,892,985], [1,251,329,996,497], [0,341,716,462,994], [2,760,127,829,189], [1,86,413,408,518], [2,340,102,918,558], [0,441,642,751,889], [1,785,292,845,325], [0,123,389,725,828], [1,905,73,983,270], [0,807,86,879,276], [2,500,866,864,916], [1,809,366,828,534], [2,219,356,720,617], [0,320,964,769,990], [0,903,167,936,631], [2,300,137,333,693], [2,5,675,755,848], [0,852,235,946,783], [2,355,556,941,664], [1,810,830,867,891], [0,509,869,667,903], [2,769,400,873,892], [1,553,614,810,729], [1,179,873,589,962], [0,466,866,768,926], [2,143,943,465,984], [2,182,380,569,552], [0,735,808,917,910], [1,731,802,910,847], [0,522,74,731,485], [1,444,127,566,996], [0,232,962,893,979], [0,231,492,790,976], [1,874,567,943,684], [2,911,840,990,932], [2,547,895,667,935], [0,93,294,648,636], [0,190,902,532,970], [0,451,530,704,613], [2,936,774,937,775], [0,116,843,533,934], [1,950,906,986,993], [1,910,51,945,989], [1,986,498,994,945], [0,125,324,433,704], [0,60,313,75,728], [1,899,494,940,947], [2,832,316,971,817], [2,994,983,998,984], [2,23,353,917,845], [2,174,799,658,859], [0,490,878,534,887], [0,623,963,917,975], [2,721,333,816,975], [2,589,687,890,921], [1,936,388,948,560], [0,485,17,655,610], [1,435,158,689,495], [1,192,934,734,936], [0,299,723,622,847], [2,484,160,812,942], [0,245,754,818,851], [1,298,419,824,634], [2,868,687,969,760], [2,131,250,685,426], [0,201,954,997,983], [1,353,910,832,961], [0,518,781,645,875], [0,866,97,924,784], [2,836,599,857,767], [1,80,957,776,968], [2,277,130,513,244], [0,62,266,854,434], [1,792,764,872,842], [0,160,949,273,989], [0,664,203,694,754], [2,491,615,998,836], [0,210,146,221,482], [0,209,780,572,894], [1,766,112,792,868], [1,222,12,856,241]]

OFF = 0
ON = 1
TOGGLE = 2

lights = Array.new(1000) { Array.new(1000, false) }

instructions.each do |instr, x1, y1, x2, y2|
  (x1..x2).each do |x|
    (y1..y2).each do |y|
      lights[x][y] = case instr
                     when OFF then false
                     when ON then true
                     when TOGGLE then !lights[x][y]
                     end
    end
  end
end

p (lights.map { |x| x.select { |y| y }.count }.inject(&:+))
